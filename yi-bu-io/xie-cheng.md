### 协程

协程：可以认为是比线程更小的执行单元，并且在一个线程中执行。又称‘微线程’。它在执行过程中，在子程序内部可中断，然后转而执行别的子程序，在适当的时候再返回来接着执行，同时还保留之前的信息。

优点：

* 极高的执行效率，因为子程序切换而不是线程切换，没有了线程切换开销。

* 不需要多线程的锁机制，因为只有一个线程，也不存在同时写变量冲突，在协程中控制共享资源不加锁，只需要判断状态就好了，所以执行效率比多线程高很多

缺陷：

协程的切换操作系统并感知，需要让执行的协程获得操作系统CPU的上下文来切换。



### 协程和线程差异 {#协程和线程差异}

线程切换从操作系统层面上，不仅保存和恢复CPU上下文，而且保存和恢复每个线程的缓存数据。因此线程的切换非常耗性能。

协程切换只是单纯的操作CPU上下，切换效率很高。



